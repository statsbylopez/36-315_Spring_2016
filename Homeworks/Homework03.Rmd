---
title: "36-315 Homework 03, Spring 2016"
author: "Your Name Here"
date: "Due Wednesday, February 3, 2016 (12pm ET) on Blackboard"
output: html_document
---

#  Homework 03:  1-D and 2-D Categorical Data; Incorporating Statistical Information into Graphs and Discussions

***General instructions for homeworks***: 

+  Use this file as the template for your homework submission.  Delete the unecessary text (e.g. this text, the problem statements, etc).  That said, keep the nicely formatted "Problem 1", "Problem 2", "a.", "b.", etc
+  Submit two files to Blackboard:  (1) an `R` Markdown file (named as:  [AndrewID]-HW03.Rmd -- e.g. "sventura-HW03.Rmd"), and (2) the corresponding .html file generated from `R` Markdown (named as:  [AndrewID]-HW03.html -- e.g. "sventura-HW03.html") to Blackboard in the Homework 03 submission section on Blackboard.  You are also welcome to upload a single .zip file containing both of these.
+  Your file should contain the code/commands to answer each question in its own code block; your code should produce plots that will be automatically embedded in the output file
+  Each answer must be supported by written statements (unless otherwise specified)
+  Include the name of anyone you collaborated with at the top of the assignment
+  Include the style guide you used at the top of the assignment

#  Problem 1

**Critiquing Graphs**:

Find a graph from the internet (last 7 days -- e.g. a news article, blog post, etc) or from an academic journal (last 60 days).  Describe and critique your graph:

a.  (5 points)  **Include the graph in your assignment**.  Two choices here:  (1) embed the graph/image in the .html file (see below for instructions) and submit it along with your other files on Blackboard, or (2) include a link to the graph in your answer to this question.
b.  (5 points)  **Describe the graph**.  What does the graph show?  What variables are plotted on the axes, via color, or via other features of the graph?
c.  (5 points)  **Critique the graph**.  Does the graph do a good job of achieving its goals?  Does the graph use an unnecessary amount of data ink?  Does the graph distort the actual effect/data/relationship?  What are the strengths and weaknesses (if any) of the graphic?  What would you change (if anything) about this graphic?
d.  (5 points)  **Critique the caption and/or surrounding text**.  Does the text enhance the user's understanding of the graphic?  What else would you include in the caption/surrounding text to help the viewer understand the graphic?

To include an image from the internet in your `R` Markdown output, use the following code (adjust the width and height as necessary):

(Note:  If you're viewing the .html file, you'll see an image below; the code to render this image is in the .Rmd file.)

<div style="width:400px">
![alt text](http://s3.amazonaws.com/media.wbur.org/wordpress/16/files/2012/12/1206_Imagine.jpg)
</div>


#  Problem 2

(3 points each)

**2-D Bar Charts and (Empirical) Conditional Distributions**

Do Problem 5 of Lab 03.  The text from that problem is copied here:

a.  Recreate the graph from problem 1 (of Lab 03), but color each bar by the `airline_sentiment` variable.  As always, make sure your graph is properly labeled/titled/colored and has a legend.
b.  Where on the graph would we find the (empirical) conditional distribution of `airline_sentiment` given that our `airline` is US Airways?
c.  Create a new graph that shows the conditional distribution of `airline` given `airline_sentiment`.  That is, you should now have three vertical bars, each of which is colored by the `airline` variable.
d.  Create a side-by-side version of the chart in (c).  To do this, specify `position = position_dodge()` in your call to `geom_bar()`.  This tells `ggplot` to reposition the bars to be side-by-side.
e.  Which graph to you prefer -- the graph in (c), or the graph in (d)?  Why?  Discuss the advantages and disadvantages of both.

#  Problem 3

**Reading Data from Google Sheets**:  

In this homework, we'll be working with a dataset from New York City's "Citi Bike" program.  The dataset contains information about all bike trips in NYC that ended at Central Park West and 72nd St in December 2015.

The data is stored in [this Google Sheet](https://docs.google.com/spreadsheets/d/143-u41MokWNU6w4_hptUypQ_sIc4ZIfEDsABq4MzDhA/edit?usp=sharing).

To read it from the Google Sheet automatically into R:

+  First, you'll need the `XML` package.  Install it.
+  Second, you'll need to download the `google-sheets-helper-functions.R` file from Blackboard ([source](http://blog.revolutionanalytics.com/2014/06/reading-data-from-the-new-version-of-google-spreadsheets.html)).  Download it and put it in the same working directory as your .Rmd file for this assignment.
+  Finally, just run the following code:

```{r}
source("google-sheets-helper-functions.R")
google_sheet_link <- "https://docs.google.com/spreadsheets/d/143-u41MokWNU6w4_hptUypQ_sIc4ZIfEDsABq4MzDhA/edit?usp=sharing"
raw_sheet_data <- readGoogleSheet(google_sheet_link)
bike_data <- cleanGoogleTable(raw_sheet_data, table=2, ncols = 15)
```

a.  (3 points)  How many rows and columns does the dataset have?
b.  (2 points)  What are the column names?
c.  (BONUS:  1 point)  All of these bike trips end at Central Pack West and 72nd St.  What nearby landmark do you think riders may be visiting?


#  Problem 4

(3 points each)

**Statistical Information in Bar Charts**

Let's explore the `birth.year` variable.  First, we want to remove any NAs from our birthyear data.

a.  Use the `na.omit()` function to remove any row that has an NA in any column.  Store the subset of data with no NAs in a new object called `bike_data_no_NA`.  How many rows does the dataset have now?

b.  Create a new variable called `birth_decade` that specifies the rider's decade of birth.  There are several ways to do this, but for now, take the substring of the first three characters of birth-year, e.g.:  `bike_data_no_NA$birth_decade <- substr(bike_data_no_NA$birth.year, 1, 3)`.  This will add a column to your `data.frame` called `birth_decade`, where, e.g., "196" represents "1960s".

c.  Look up the help documentation for the `paste()` function.  How can you use the `paste()` function to add the string "0s" to the end of your decade variable so the decades are properly formatted?  Do this.

d.  Make a bar chart of the decade variable.  Make sure that the decades are displayed in a logical order.  Make sure you use a proper title and axis labels.

e.  Describe the distribution of `birth_decade` in your bar chart.  Which decades are most common?  Which are least common?  Are there any chronological trends (linear or otherwise)?

f.  Recreate the same graph, but use proportions instead of counts/frequencies on the y-axis.  Add error bars corresponding to an approximate 95% confidence interval around the proportion of observations in each category.  Describe any relationships you see.

g.  Run a chi-square test where the null hypothesis is that all decades in your data have an equal proportion of observations.  What is the resulting p-value?  What do you conclude regarding the null hypothesis?

h.  Repeat parts (f) and (g), but using a subset of riders born in the 1960s, 1970s, and 1980s.  To do this, you can use the following code to get the correct subset of data:  `bike_data_60s_70s_80s <- subset(bike_data_no_NA, birth_decade %in% c("1960s", "1970s", "1980s"))`.  Do any of your conclusions change?



#  Problem 5

(5 points each)

**2-D Bar Charts**

For parts (a) and (b), use the `grid.arrange` function to arrange your graphs into a 1x2 grid.

a.  Create a stacked bar chart that shows the (empirical) conditional distributions of `gender` given each `birth_decade`.  Be sure to use a proper title, proper labels, and easily understandable and labeled colors.  Describe your graph.  Which gender is more common?  Does this change depending on the decade?  Feel free to reference the [online Citi Bike documentation](http://www.citibikenyc.com/system-data) to help you decode the genders.

b.  Create a side-by-side bar chart that shows the (empirical) conditional distributions of `gender` given each `birth_decade`.  Be sure to use a proper title, proper labels, and easily understandable and labeled colors.  Describe your graph.  

c.  Which graph do you prefer?  Why?  Justify your choice.


#  Problem 6

(3 points each)

**More 2-D Bar Charts**

Now, we'll flip the variables in the conditional distributions from Problem 5.  For the graphs in parts (a), (b), and (g), use the `grid.arrange` function to arrange your graphs into a 2x2 grid.  For all parts, be sure to use the `bike_data_no_NA` version of our dataset -- NOT the subset from the 1960s, 70s, and 80s.

a.  Create a stacked bar chart that shows the (empirical) conditional distributions of `birth_decade` given each `gender`.  Be sure to use a proper title, proper labels, and easily understandable and labeled colors.

b.  Create a side-by-side bar chart that shows the (empirical) conditional distributions of `birth_decade` given each `gender`.  Be sure to use a proper title, proper labels, and easily understandable and labeled colors.

c.  Describe the (empirical) marginal distribution of `gender`  In which graph -- (a) or (b) -- is it easier to obtain information about the marginal distribution of `gender`?

d.  Describe the (empirical) conditional distribution of `birth_decade` given that the rider is female.  In which graph -- (a) or (b) -- is it easier to obtain information about the conditional distribution of `birth_decade` given gender?

e.  Describe the conditional distribution of `birth_decade` given that the rider is male.

f.  Compare the two conditional distributions.  Are there any similarities?  Are there any differences?

g.  Flip the axes on the graphs from (a) and (b) so that the bars are horizontal.  Do you prefer the vertical bar charts or the horizontal bar charts?
